//--------------------------------------------------------------------------------------------//
//                         APPLYING SCALE FACTOR OF MUON                                      //
//--------------------------------------------------------------------------------------------//

float VLLAna:: Muon2016SF( float pt, float eta ){
  //cout<<"Muon2016 SF called"<<endl;
  float BCDEF_lumi = 5747.0+2573.0+4242.0+4025.0+3105.0;
  float GH_lumi    = 7576.0+8651.0;
  //
  float BCDEF_sf   = Muon2016SF_BCDEF( pt, eta );
  float GH_sf      = Muon2016SF_GH(    pt, eta );
  //
  return ((BCDEF_sf*BCDEF_lumi)+(GH_sf*GH_lumi))/(BCDEF_lumi+GH_lumi); //lumi weighted
}

//2016: ERA=BCDEF
float VLLAna::Muon2016SF_BCDEF( float pt, float eta){
  //
  if( pt<5.0 || eta>2.4 ) return 0.0;
  //
  float SF=1.;
  // SF = (MediumID SF) * (TightRelIso SF)
  if(pt>10.0 && pt<=20.0){ 
    float SFid=1.;
    float SFiso=1.;
    //
    if(pt>10.0 && pt<=15.0){
      if(fabs(eta)<=0.9){
	SFid=0.9813446248941771;
      } 
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
	SFid=0.9723820542350555;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
	SFid=0.9792842273885548;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
	SFid=0.9129662208927507;
      }
    }
    else if(pt>15.0 && pt<=20.0){
      if(fabs(eta)<=0.9){
	SFid=0.9821497407424419;
      } 
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
	SFid=0.9673227740383241;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
	SFid=0.9925158918908051;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
	SFid=1.0;
      }
    }
    // 
    if(pt>10.0 && pt<=13.0){
      if(fabs(eta)<=0.9){
	SFiso=0.966121;
      } 
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
	SFiso=0.97219;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
	SFiso=0.960163;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
	SFiso=0.944529;
      }
    }
    else if(pt>13.0 && pt<=16.0){
      if(fabs(eta)<=0.9){
	SFiso=0.953104;
      } 
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
	SFiso=0.986728;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
	SFiso=0.967006;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
	SFiso=0.955838;
      }
    }
    if(pt>16.0 && pt<=20.0){
      if(fabs(eta)<=0.9){
	SFiso=0.982328;
      } 
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
	SFiso=0.969682;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
	SFiso=0.974194;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
	SFiso=0.951495;
      }
    }
    //
    SF = SFid*SFiso;
  }
  else if(pt>20.0){
    if(eta>-2.4 && eta<=-2.3){
      if(pt>20.0 && pt<=25.0){
	SF=0.996756139493*0.958952275266;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.988275196846*0.979906265042;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.986241751477*0.996522300825;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.98661642221*0.998625649649;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.98006671713*0.996755209811;
      }
      else if(pt>60.0){
	SF=0.992673338475*0.999302158012;
      }
    }
    else if(eta>-2.3 && eta<=-2.2){
      if(pt>20.0 && pt<=25.0){
	SF=0.959421071546*0.97243357371;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.964179807346*0.988601644307;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.960534571799*0.993389741698;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.967241233377*0.998905379029;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.964975219173*0.996216562103;
      }
      else if(pt>60.0){
	SF=0.971157771267*0.999535942811;
      }
    }
    else if(eta>-2.2 && eta<=-2.1){
      if(pt>20.0 && pt<=25.0){
	SF=0.891205848989*0.969728136966;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.888914396582*0.980401861258;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.893489835421*0.991195546309;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.897339485384*0.996293308237;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.889183849946*1.00039330586;
      }
      else if(pt>60.0){
	SF=0.918950656424*1.0033306778;
      }
    }
    else if(eta>-2.1 && eta<=-2.0){
      if(pt>20.0 && pt<=25.0){
	SF=0.957150084974*0.989025884191;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.948174924892*0.989216736187;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.946658336797*0.993940987996;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.952401976465*0.995701615353;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.958050142191*0.997386940192;
      }
      else if(pt>60.0){
	SF=0.974705908596*0.99738398881;
      }
    }
    else if(eta>-2.0 && eta<=-1.7){
      if(pt>20.0 && pt<=25.0){
	SF=0.972080550869*0.986085949622;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.976694418159*0.98909114776;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.978802783567*0.994806093681;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.980906354303*0.996282986337;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.979902263055*0.99806352168;
      }
      else if(pt>60.0){
	SF=0.98713769166*0.99840069008;
      }
    }
    else if(eta>-1.7 && eta<=-1.6){
      if(pt>20.0 && pt<=25.0){
	SF=0.991543046296*0.974941572841;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.993762857619*0.986208931626;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.994172307819*0.995611599411;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.996598208832*0.996824803261;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.994057784279*0.996448460259;
      }
      else if(pt>60.0){
	SF=0.993223122212*1.00039801461;
      }
    }
    else if(eta>-1.6 && eta<=-1.5){
      if(pt>20.0 && pt<=25.0){
	SF=1.00073651418*0.977816229867;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.99369582672*0.990181627557;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.997802774219*0.996920391354;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.995824008054*0.998019987617;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.993821286268*0.997988882521;
      }
      else if(pt>60.0){
	SF=1.00222829043*0.999240708872;
      }
    }
    else if(eta>-1.5 && eta<=-1.4){
      if(pt>20.0 && pt<=25.0){
	SF=0.993337844747*0.985464341981;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.993585020414*0.989335888195;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.994057940879*0.995308851097;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.994715755499*0.997213089264;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.993005382704*0.996851944997;
      }
      else if(pt>60.0){
	SF=0.995376511977*0.99991697263;
      }
    }
    else if(eta>-1.4 && eta<=-1.2){
      if(pt>20.0 && pt<=25.0){
	SF=1.00922962602*0.982661606686;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.990750452487*0.994148951809;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.997309190681*0.994147100669;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.998458557115*0.996192722166;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.993544681911*0.997144928948;
      }
      else if(pt>60.0){
	SF=0.998407682744*0.997052154614;
      }
    }
    else if(eta>-1.2 && eta<=-0.8){
      if(pt>20.0 && pt<=25.0){
	SF=1.00577647464*0.988984474587;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.996985281134*0.990091568679;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.996439183507*0.994276573359;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.996267434619*0.996428266235;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.991002847892*0.998577014706;
      }
      else if(pt>60.0){
	SF=0.998246199467*0.999745215077;
      }
    }
    else if(eta>-0.8 && eta<=-0.5){
      if(pt>20.0 && pt<=25.0){
	SF=1.00358257342*0.981170544306;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00233223337*0.994371360804;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.995666593744*0.994603133122;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.995667752495*0.996243040425;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.992436915605*0.996944603866;
      }
      else if(pt>60.0){
	SF=1.00511604638*0.998195918365;
      }
    }
    else if(eta>-0.5 && eta<=-0.3){
      if(pt>20.0 && pt<=25.0){
	SF=1.00528151813*0.97731117097;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.99458885257*0.991088302633;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.995002002449*0.992988736276;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.997766970641*0.995737150277;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.996044244976*0.99679721297;
      }
      else if(pt>60.0){
	SF=1.00570251323*0.99942013164;
      }
    }
    else if(eta>-0.3 && eta<=-0.2){
      if(pt>20.0 && pt<=25.0){
	SF=0.99347729574*0.986267634438;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.992638357755*0.992052511958;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.984461405228*0.995637060081;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.985163214162*0.995796252447;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.976988535627*0.997082382682;
      }
      else if(pt>60.0){
	SF=0.990169989341*0.998143558621;
      }
    }
    else if(eta>-0.2 && eta<=0.0){
      if(pt>20.0 && pt<=25.0){
	SF=0.971132181641*0.976843457751;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.990464828796*0.989858943202;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.993416020333*0.995175718055;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.993495399263*0.995615997881;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.989813551898*0.997427787834;
      }
      else if(pt>60.0){
	SF=0.992787288053*0.999738766302;
      }
    }
    else if(eta>0.0 && eta<=0.2){
      if(pt>20.0 && pt<=25.0){
	SF=1.0002820039*0.998586336504;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.991643725947*0.997016356704;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.994355283623*0.996392953749;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.996131795158*0.995980329555;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.990384802278*0.997576197425;
      }
      else if(pt>60.0){
	SF=0.993094985927*0.997970269818;
      }
    }
    else if(eta>0.2 && eta<=0.3){
      if(pt>20.0 && pt<=25.0){
	SF=0.97628708388*0.983659049877;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.994061129841*0.990656209844;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.986634967123*0.996501303233;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.989162261532*0.99713937914;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.980958617683*1.00071014493;
      }
      else if(pt>60.0){
	SF=0.998168746977*0.997019386462;
      }
    }
    else if(eta>0.3 && eta<=0.5){
      if(pt>20.0 && pt<=25.0){
	SF=1.00763697496*0.994813148673;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00242700065*0.997028871327;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.996319593286*0.998262128687;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.997384445466*0.997983140762;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.994770791428*0.998553242451;
      }
      else if(pt>60.0){
	SF=1.0051978831*1.0012788492;
      }
    }
    else if(eta>0.5 && eta<=0.8){
      if(pt>20.0 && pt<=25.0){
	SF=1.00389475697*0.994587781457;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00561720427*1.00458515171;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.997692809981*0.998977800167;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.997184095332*0.998374019791;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.99068374657*0.998246783808;
      }
      else if(pt>60.0){
	SF=0.998578249716*0.999860612457;
      }
    }
    else if(eta>0.8 && eta<=1.2){
      if(pt>20.0 && pt<=25.0){
	SF=1.00505983098*0.984711703875;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.995760699081*1.00432907536;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.996449143559*0.997621199568;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.996903661046*0.99726671769;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.995709974972*0.99852914048;
      }
      else if(pt>60.0){
	SF=0.993399527164*0.998836636811;
      }
    }
    else if(eta>1.2 && eta<=1.4){
      if(pt>20.0 && pt<=25.0){
	SF=1.00568533671*0.984470550229;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00194582598*0.991007145231;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.998511126531*0.993147401284;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00040669537*0.995910901373;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.989099577032*0.998113214222;
      }
      else if(pt>60.0){
	SF=0.991027373154*0.999637794913;
      }
    }
    else if(eta>1.4 && eta<=1.5){
      if(pt>20.0 && pt<=25.0){
	SF=1.00350873572*0.985796327866;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00286515923*0.985533300958;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.999568224621*0.992809060212;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00201717293*0.996130093282;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.985406086836*0.995902097674;
      }
      else if(pt>60.0){
	SF=1.00000045673*0.998649135012;
      }
    }
    else if(eta>1.5 && eta<=1.6){
      if(pt>20.0 && pt<=25.0){
	SF=1.00380810533*0.988263041213;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00105682899*0.996402491552;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=1.00129882945*0.992740747957;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00295466797*0.995721693357;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.996439675128*0.999904914803;
      }
      else if(pt>60.0){
	SF=1.00577332805*0.99889638474;
      }
    }
    else if(eta>1.6 && eta<=1.7){
      if(pt>20.0 && pt<=25.0){
	SF=0.999993176433*0.974528950971;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.0009178206*0.988022513953;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.99955629731*0.992379513554;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00225165385*0.995713866779;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.998165629581*0.99807502581;
      }
      else if(pt>60.0){
	SF=0.991003342631*0.995306566652;
      }
    }
    else if(eta>1.7 && eta<=2.0){
      if(pt>20.0 && pt<=25.0){
	SF=0.98210696164*0.979161174632;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.979772122031*0.988613404685;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.982132058736*0.995146690804;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.985208351092*0.996607324796;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.984940092233*0.99742842513;
      }
      else if(pt>60.0){
	SF=0.983419978739*0.999467635601;
      }
    }
    else if(eta>2.0 && eta<=2.1){
      if(pt>20.0 && pt<=25.0){
	SF=0.954619146938*0.980941020177;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.953133796998*0.985464028398;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.959345133741*0.992509286496;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.960784166495*0.996009728043;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.960515957559*0.997010316156;
      }
      else if(pt>60.0){
	SF=0.970500491075*0.996971107615;
      }
    }
    else if(eta>2.1 && eta<=2.2){
      if(pt>20.0 && pt<=25.0){
	SF=0.895486910318*0.967445145669;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.890111073046*0.984765270536;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.883508966713*0.993544541521;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.898758814558*0.99638305687;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.897761189459*0.997813071305;
      }
      else if(pt>60.0){
	SF=0.907851294407*1.001431826;
      }
    }
    else if(eta>2.2 && eta<=2.3){
      if(pt>20.0 && pt<=25.0){
	SF=0.973784191833*0.974686154046;
    }
      else if(pt>25.0 && pt<=30.0){
	SF=0.959493138312*0.988350949197;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.963438468957*0.988187617827;
    }
      else if(pt>40.0 && pt<=50.0){
	SF=0.960435868313*0.995463581743;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.96386264351*0.997411694885;
      }
      else if(pt>60.0){
	SF=0.965631591072*1.00194083908;
      }
    }
    else if(eta>2.3 && eta<=2.4){
      if(pt>20.0 && pt<=25.0){
	SF=0.999758176563*0.97206917723;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.979029518462*0.974548541838;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.990185395919*0.987702552902;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.98590922899*0.994743302627;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.991517575368*0.99439407288;
      }
      else if(pt>60.0){
	SF=0.991361262564*1.00314067043;
      }
    }
  }
  //
  return SF;  
}

float VLLAna::Muon2016SF_GH( float pt, float eta ){
  //
  if( pt<5 || eta>2.4 ) return 0.0;
  //
  float SF=1.;
  // SF = (MediumID SF) * (TightRelIso SF)
  if(pt>10.0 && pt<=20.0){
    float SFid=1.;
    float SFiso=1.;
    //
    if(pt>10 && pt<=15){
      if(fabs(eta)<=0.9){
	SFid=0.9879042253103082;
      } 
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
	SFid=0.9967926301187364;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
	SFid=1.003777123844482;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
	SFid=0.6222649291797591;
      }
    }
    else if(pt>15 && pt<=20){
      if(fabs(eta)<=0.9){
	SFid=0.9758918510725427;
      } 
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
	SFid=0.992081150687448;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
	SFid=0.9726749782206534;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
	SFid=1.0;
      }
    }
    //
    if(pt>10 && pt<=13){
      if(fabs(eta)<=0.9){
        SFiso=0.958672;
      }
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
        SFiso=0.97367;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
        SFiso=0.967415;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
        SFiso=0.947473;
      }
    }
    else if(pt>13 && pt<=16){
      if(fabs(eta)<=0.9){
        SFiso=0.96603;
      }
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
        SFiso=0.983159;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
        SFiso=0.97707;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
        SFiso=0.971466;
      }
    }
    else if(pt>16 && pt<=20){
      if(fabs(eta)<=0.9){
        SFiso=0.976523;
      }
      else if(fabs(eta)<=1.2 && fabs(eta)>0.9){
        SFiso=0.970764;
      }
      else if(fabs(eta)<=2.1 && fabs(eta)>1.2){
        SFiso=0.980392;
      }
      else if(fabs(eta)<=2.4 && fabs(eta)>2.1){
        SFiso=0.980871;
      }
    }
    //
    SF = SFid*SFiso;
  }
  else if (pt>20.0){
    //
    if(eta>-2.4 && eta<=-2.3){
      if(pt>20.0 && pt<=25.0){
	SF=0.997282260534*0.978470203869;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.994533286657*0.991034336571;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.992575854257*1.0023316567;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.988899727809*1.00057127869;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.992203897747*1.00007221689;
      }
      else if(pt>60.0){
	SF=0.994688877894*0.999138593871;
      }
    }
    else if(eta>-2.3 && eta<=-2.2){
      if(pt>20.0 && pt<=25.0){
	SF=0.991007863945*0.991401826576;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00344349211*1.00340625915;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.996648638242*0.999513581009;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.993324863521*1.00215843551;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.987108526443*0.9999045657;
      }
      else if(pt>60.0){
	SF=0.999999992039*1.00175408707;
      }
    }
    else if(eta>-2.2 && eta<=-2.1){
      if(pt>20.0 && pt<=25.0){
	SF=0.939375081506*1.00158129561;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.934617786984*0.994875937853;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.935333554217*0.998804839198;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.938881793558*0.998323331474;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.924241313581*1.00032289889;
      }
      else if(pt>60.0){
	SF=0.932634719467*1.00226204582;
      }
    }
    else if(eta>-2.1 && eta<=-2.0){
      if(pt>20.0 && pt<=25.0){
	SF=0.986974445894*1.00644966948;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.989147510736*0.996314699883;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.99133974208*1.00234019453;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.994547629137*0.999146335956;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.994592355492*0.99823465206;
      }
      else if(pt>60.0){
	SF=0.992587173688*0.995677980902;
      }
    }
    else if(eta>-2.0 && eta<=-1.7){
      if(pt>20.0 && pt<=25.0){
	SF=0.983166095143*0.996255011881;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.985615639501*0.998661562227;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.986971170969*0.999204049887;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.988103334639*0.998950094351;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.98814124537*0.99992124272;
      }
      else if(pt>60.0){
	SF=0.988478030202*0.999528944581;
      }
    }
    else if(eta>-1.7 && eta<=-1.6){
      if(pt>20.0 && pt<=25.0){
	SF=1.00431176602*0.980784167386;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.989919390625*0.994382503519;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.996454626435*0.998839653594;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.997641451035*0.997867270832;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.994838942941*0.996098844736;
      }
      else if(pt>60.0){
	SF=0.988658081184*1.00026712818;
      }
    }
    else if(eta>-1.6 && eta<=-1.5){
      if(pt>20.0 && pt<=25.0){
	SF=0.997992363124*0.991498209952;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00220862194*0.992545418818;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.997466072222*0.999248485515;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.998414606199*0.999199004102;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.995060546088*0.999489240712;
      }
      else if(pt>60.0){
	SF=1.00222795659*0.997106646654;
      }
    }
    else if(eta>-1.5 && eta<=-1.4){
      if(pt>20.0 && pt<=25.0){
	SF=1.00245496024*0.991992531655;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.996780303478*0.99270293735;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=1.00080640912*0.994505078752;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.999997683159*0.997648022944;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.997699768087*0.99736648904;
      }
      else if(pt>60.0){
	SF=0.988775814284*0.998066310278;
      }
    }
    else if(eta>-1.4 && eta<=-1.2){
      if(pt>20.0 && pt<=25.0){
	SF=1.00716006217*0.97952028228;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.998841240293*0.991978866273;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=1.00001665051*0.99408290755;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00021930511*0.996070632192;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.9966519003*0.996764381424;
      }
      else if(pt>60.0){
	SF=0.995500117444*0.997659282988;
      }
    }
    else if(eta>-1.2 && eta<=-0.8){
      if(pt>20.0 && pt<=25.0){
	SF=0.994679256502*0.989719803223;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.999187265864*0.991690204027;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.99603614702*0.994654124008;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.998863398751*0.99652281727;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.993343460068*0.998369299034;
      }
      else if(pt>60.0){
	SF=1.00186779223*0.999710336867;
      }
    }
    else if(eta>-0.8 && eta<=-0.5){
      if(pt>20.0 && pt<=25.0){
	SF=0.996228871871*0.98154279892;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00121191521*0.994674650597;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.997286768368*0.994426620759;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.998742073805*0.995753020008;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.99473050533*0.996924947216;
      }
      else if(pt>60.0){
	SF=0.997668732246*0.999630900547;
      }
    }
    else if(eta>-0.5 && eta<=-0.3){
      if(pt>20.0 && pt<=25.0){
	SF=1.00528142744*0.970770764691;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.995074945616*0.988971733125;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.997156198693*0.993308911982;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.999812022006*0.993648845393;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.994848942498*0.995344796925;
      }
      else if(pt>60.0){
      SF=1.00570243147*0.997543511403;
      }
    }
    else if(eta>-0.3 && eta<=-0.2){
      if(pt>20.0 && pt<=25.0){
	SF=0.991292839716*0.975641845203;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.986808125652*0.99177512355;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.991040328258*0.992480359118;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.991910277289*0.99448289442;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.986856824735*0.994418380619;
      }
      else if(pt>60.0){
	SF=0.99401145233*0.997956231726;
      }
    }
    else if(eta>-0.2 && eta<=0.0){
      if(pt>20.0 && pt<=25.0){
	SF=0.983240191261*0.964436624902;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.995669864237*0.985915072788;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.999475784215*0.990537381239;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00126487542*0.994376321644;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.997385122424*0.996448757699;
      }
      else if(pt>60.0){
	SF=0.998953070359*0.99896874362;
      }
    }
    else if(eta>0.0 && eta<=0.2){
      if(pt>20.0 && pt<=25.0){
	SF=1.00343698475*0.988680713354;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.0020180459*0.994499735074;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.99695853969*0.990873512898;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.999801547102*0.994071503603;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.998511864402*0.996961766378;
      }
      else if(pt>60.0){
	SF=1.00172983836*0.998426837849;
      }
    }
    else if(eta>0.2 && eta<=0.3){
      if(pt>20.0 && pt<=25.0){
	SF=0.992967682422*0.982909075902;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.997192286073*0.988244722383;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.993780208696*0.99092711611;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.993189499194*0.995606355333;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.989258144286*0.998481247638;
      }
      else if(pt>60.0){
	SF=1.00341932724*0.996346970977;
      }
    }
    else if(eta>0.3 && eta<=0.5){
      if(pt>20.0 && pt<=25.0){
	SF=1.00763700567*0.993173651373;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00345472373*0.99418204659;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.996765767296*0.995683692816;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00038588647*0.99622176355;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.997951879723*0.997578213726;
      }
      else if(pt>60.0){
	SF=1.00319392971*1.00080191455;
      }
    }
    else if(eta>0.5 && eta<=0.8){
      if(pt>20.0 && pt<=25.0){
	SF=1.0038955361*0.982447750369;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00267475356*0.995345417889;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.99773579236*0.997753052976;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00048395236*0.99804984591;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.993774718878*0.998372270808;
      }
      else if(pt>60.0){
	SF=0.995522775265*1.0005052771;
      }
    }
    else if(eta>0.8 && eta<=1.2){
      if(pt>20.0 && pt<=25.0){
	SF=0.99982355177*0.984507301865;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.996451627269*0.997807350201;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.996835413362*0.997207216048;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.998206990218*0.997222891934;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.98919574063*0.99668393854;
      }
      else if(pt>60.0){
	SF=0.996696731323*0.997909309287;
      }
    }
    else if(eta>1.2 && eta<=1.4){
      if(pt>20.0 && pt<=25.0){
	SF=1.00563959298*0.982114789984;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00447608603*0.989267053556;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=1.0053815942*0.993160519545;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00458647748*0.995614899417;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.990742977224*0.998032288844;
      }
      else if(pt>60.0){
	SF=1.00570893585*1.00219240366;
      }
    }
    else if(eta>1.4 && eta<=1.5){
      if(pt>20.0 && pt<=25.0){
	SF=1.00471862958*0.989052382916;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.00286515988*0.984977123968;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=1.00391148351*0.992167323852;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00524560735*0.996176992545;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.986735701178*0.997991977231;
      }
      else if(pt>60.0){
	SF=1.00000046114*1.0012166155;
      }
    }
    else if(eta>1.5 && eta<=1.6){
      if(pt>20.0 && pt<=25.0){
	SF=1.00380812015*0.991412191856;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.992434615769*0.994658630965;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=1.00190718828*0.993665084884;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00761961426*0.996984279985;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.992250777999*0.999965814594;
      }
      else if(pt>60.0){
	SF=0.998845861358*1.0001969175;
      }
    }
    else if(eta>1.6 && eta<=1.7){
      if(pt>20.0 && pt<=25.0){
	SF=1.00171169548*0.980835189878;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=1.0000681042*0.992469956769;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=1.00248460618*0.994001483634;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=1.00612704674*0.996541644233;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.98621421954*0.997202048528;
      }
      else if(pt>60.0){
	SF=0.986256418643*0.994799099076;
      }
    }
    else if(eta>1.7 && eta<=2.0){
      if(pt>20.0 && pt<=25.0){
	SF=0.990150294495*0.986792676625;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.992421865091*0.994417477139;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.992653538654*0.99771184006;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.99428635576*0.998042774107;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.988565544612*0.998306458779;
      }
      else if(pt>60.0){
	SF=0.989945748258*1.00043751927;
      }
    }
    else if(eta>2.0 && eta<=2.1){
      if(pt>20.0 && pt<=25.0){
	SF=0.986759880763*0.990508681316;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.993307819253*0.9953097273;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.995049283937*0.997354504541;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.996483766862*0.997917316021;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.988637864678*0.996778535683;
      }
      else if(pt>60.0){
	SF=0.999716365503*0.998126452397;
      }
    }
    else if(eta>2.1 && eta<=2.2){
      if(pt>20.0 && pt<=25.0){
	SF=0.950081103731*0.989887212675;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.946054861001*0.99463427846;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.939709691299*0.998383129327;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.946291478574*0.999201460275;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.948653457311*0.999432919858;
      }
      else if(pt>60.0){
	SF=0.950824761465*1.00550714951;
      }
    }
    else if(eta>2.2 && eta<=2.3){
      if(pt>20.0 && pt<=25.0){
	SF=0.997363734149*0.984211491317;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.999985532693*0.994695424608;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.996124823372*0.993436543344;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.996794777216*0.998422358094;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=1.00201800079*0.998568232594;
      }
      else if(pt>60.0){
	SF=1.00270415721*1.00210708062;
      }
    }
    else if(eta>2.3 && eta<=2.4){
      if(pt>20.0 && pt<=25.0){
	SF=1.00580401805*0.986003860233;
      }
      else if(pt>25.0 && pt<=30.0){
	SF=0.988366769981*0.989106925613;
      }
      else if(pt>30.0 && pt<=40.0){
	SF=0.990609204252*0.991202224627;
      }
      else if(pt>40.0 && pt<=50.0){
	SF=0.992903576097*0.997734518544;
      }
      else if(pt>50.0 && pt<=60.0){
	SF=0.992756390969*0.99558212244;
    }
      else if(pt>60.0){
	SF=1.00054693941*1.00325990572;
      }
    }
  }
  //
  return SF;  
}


float VLLAna:: Muon2017SF( float pt, float eta ){
  //
  if( pt<5. || eta>2.4 ) return 0.0;
  //
  float SF=1.;
  // SF = (MediumID SF) * (TightRelIso SF)
  if( fabs(eta)>2.1 && fabs(eta)<=2.4 ) {
    if (pt>10. && pt<=20.) {
        float SFid=1.;
        float SFiso=1.;
        //
        if(pt>10. && pt<=13.){
            SFiso=0.983237;
        }
        else if(pt>13. && pt<=16.){
            SFiso=0.981745;
        }
        else if(pt>16. && pt<=20.){
            SFiso=0.987663;
        }
        //
        if(pt>10. && pt<=15.){
            SFid=0.95821928322817451;
        }
        else if(pt>15. && pt<=20.){
            SFid=1.0;
        }
        SF = SFid*SFiso;
    }
    else if(pt>20. && pt<=25.){
      SF=0.977145069827941*0.9886316115349121;
    }
    else if(pt>25. && pt<=30.){
      SF=0.9782924087364798*0.9925076660108119;
    }
    else if(pt>30. && pt<=40.){
      SF=0.9809396294596907*0.9947286883781966;
    }
    else if(pt>40. && pt<=50.){
      SF=0.9787974300910186*0.9978171654983231;
    }
    else if(pt>50. && pt<=60.){
      SF=0.9725537593862011*0.9990417880103375;
    }
    else if(pt>60.          ){
      SF=0.9814903068452708*0.9983526401032815;
    }
  }
  else if( fabs(eta)>1.2 && fabs(eta)<=2.1 ) {
    if (pt>10. && pt<=20.) {
        float SFid=1.;
        float SFiso=1.;
        //
        if(pt>10. && pt<=13.){
            SFiso=1.00237;
        }
        else if(pt>13. && pt<=16.){
            SFiso=0.998118;
        }
        else if(pt>16. && pt<=20.){
            SFiso=0.996315;
        }
        //
        if(pt>10. && pt<=15.){
            SFid=1.0018820510270987;
        }
        else if(pt>15. && pt<=20.){
            SFid=0.99998638463147949;
        }
        SF = SFid*SFiso;
    }  
    else if(pt>20. && pt<=25.){
      SF=0.9955084323163591*0.991330938888712;
    }
    else if(pt>25. && pt<=30.){
      SF=0.9943996196727576*0.9941259178977855;
    }
    else if(pt>30. && pt<=40.){
      SF=0.9984999038586462*0.9955778030021415;
    }
    else if(pt>40. && pt<=50.){
      SF=0.9965521652973813*0.9974693077739502;
    }
    else if(pt>50. && pt<=60.){
      SF=0.9945114679438982*0.9985255821937502;
    }
    else if(pt>60.          ){
      SF=0.9966682766607513*0.9996253285488446;
    }
  }
  else if( fabs(eta)>0.9 && fabs(eta)<=1.2 ) {
    if (pt>10. && pt<=20.) {
        float SFid=1.;
        float SFiso=1.;
        //
        if(pt>10. && pt<=13.){
            SFiso=1.00455;
        }
        else if(pt>13. && pt<=16.){
            SFiso=0.998662;
        }
        else if(pt>16. && pt<=20.){
            SFiso=0.991468;
        }
        //
        if(pt>10. && pt<=15.){
            SFid=1.0013607376889935;
        }
        else if(pt>15. && pt<=20.){
            SFid=0.99999464276953354;
        }
        SF = SFid*SFiso;
    }    
    else if(pt>20. && pt<=25.){
      SF=1.0049979914991105*0.9941510395478486;
    }
    else if(pt>25. && pt<=30.){
      SF=0.9966750735129407*0.9887957971141935;
    }
    else if(pt>30. && pt<=40.){
      SF=0.9996033523083256*0.9942725441742639;
    }
    else if(pt>40. && pt<=50.){
      SF=0.9976598767211405*0.9967217026068454;
    }
    else if(pt>50. && pt<=60.){
      SF=0.996516601025578*0.9989573851833544;
    }
    else if(pt>60.          ){
      SF=0.9958169894400356*0.9999856599296201;
    }
  }
  else if(                 fabs(eta)<=0.9 ) { 
    if (pt>10. && pt<=20.) {
        float SFid=1.;
        float SFiso=1.;
        //
        if(pt>10. && pt<=13.){
            SFiso=0.981881;
        }
        else if(pt>13. && pt<=16.){
            SFiso=0.990038;
        }
        else if(pt>16. && pt<=20.){
            SFiso=0.995755;
        }
        //
        if(pt>10. && pt<=15.){
            SFid=0.99541169498918591;
        }
        else if(pt>15. && pt<=20.){
            SFid=0.99497238361279694;
        }
        SF = SFid*SFiso;
    }   
    else if(pt>20. && pt<=25.){
      SF=0.9950588122087007*0.9919136619222616;
    }
    else if(pt>25. && pt<=30.){
      SF=0.9945359506903128*0.997224241407353;
    }
    else if(pt>30. && pt<=40.){
      SF=0.9983110301789869*0.9975957108350414;
    }
    else if(pt>40. && pt<=50.){
      SF=0.9965536147351479*0.9981218946117296;
    }
    else if(pt>50. && pt<=60.){
      SF=0.9934897458745519*0.9984034395523944;
    }
    else if(pt>60.          ){
      SF=0.9970925282581047*0.9996174748336174;
    }
  }
  
  return SF;  
}

float VLLAna:: Muon2018SF( float pt, float eta )
{
  //
  if( pt<5 || eta>2.4 ) return 0.0;;
  //
  float SF=1.;
  // SF = (MediumID SF) * (TightRelIso SF)
  if( fabs(eta)>2.1 && fabs(eta)<=2.4 ) {
    if (pt>10. && pt<=20.) {
      float SFid=1.;
      float SFiso=1.;
      //
      if(pt>10. && pt<=13.){
	SFiso=1.12047;
      }
      else if(pt>13. && pt<=16.){
	SFiso=1.10101;
      }
      else if(pt>16. && pt<=20.){
	SFiso=1.08231;
      }
      //
      if(pt>10. && pt<=15.){
	SFid=0.9676717601696864;
      }
      else if(pt>15. && pt<=20.){
	SFid=1.0;
      }
      SF = SFid*SFiso;
    }
    else if(pt>20 && pt<=25){
      SF=0.9758852098103937*1.0653280092553012;
    }
    else if(pt>25 && pt<=30){
      SF=0.974693962155391*1.0435275603506486;
    }
    else if(pt>30 && pt<=40){
      SF=0.9761962799324392*1.0252235483989323;
    }
    else if(pt>40 && pt<=50){
      SF=0.9731181137820818*1.0124813495371339;
    }
    else if(pt>50 && pt<=60){
      SF=0.9751144153730475*1.007102696957796;
    }
    else if(pt>60          ){
      SF=0.9745463398566625*1.0045863747864294;
    }
  }
  else if( fabs(eta)>1.2 && fabs(eta)<=2.1 ) {
    if (pt>10. && pt<=20.) {
      float SFid=1.;
      float SFiso=1.;
      //
      if(pt>10. && pt<=13.){
	SFiso=1.05752;
      }
      else if(pt>13. && pt<=16.){
	SFiso=1.05284;
      }
      else if(pt>16. && pt<=20.){
	SFiso=1.0414;
      }
      //
      if(pt>10. && pt<=15.){
	SFid=0.9990739155301513;
      }
      else if(pt>15. && pt<=20.){
	SFid=1.007003846164823;
      }
      SF = SFid*SFiso;
    }
    else if(pt>20 && pt<=25){
      SF=0.9948390398697027*1.0287432256996452;
    }
    else if(pt>25 && pt<=30){
      SF=0.9944627157879012*1.0200709229291791;
    }
    else if(pt>30 && pt<=40){
      SF=0.9950555785494614*1.0103313664053777;
    }
    else if(pt>40 && pt<=50){
      SF=0.9947165774039408*1.0051877686811932;
    }
    else if(pt>50 && pt<=60){
      SF=0.9952059537543975*1.0028513047622143;
    }
    else if(pt>60          ){
      SF=0.9951698547321054*1.0019835090281612;
    }
  }
  else if( fabs(eta)>0.9 && fabs(eta)<=1.2 ) {
    if (pt>10. && pt<=20.) {
      float SFid=1.;
      float SFiso=1.;
      //
      if(pt>10. && pt<=13.){
	SFiso=0.986116;
      }
      else if(pt>13. && pt<=16.){
	SFiso=0.969869;
      }
      else if(pt>16. && pt<=20.){
	SFiso=0.993045;
      }
      //
      if(pt>10. && pt<=15.){
	SFid=0.9912291156332008;
      }
      else if(pt>15. && pt<=20.){
	SFid=0.9962640329485886;
      }
      SF = SFid*SFiso;
    }
    else if(pt>20 && pt<=25){
      SF=0.9958009385152335*0.9864189571054587;
    }
    else if(pt>25 && pt<=30){
      SF=0.995658649862899*0.9905480054634463;
    }
    else if(pt>30 && pt<=40){
      SF=0.9958205457562612*0.9935807370274083;
    }
    else if(pt>40 && pt<=50){
      SF=0.9956720751857815*0.9964126900350697;
    }
    else if(pt>50 && pt<=60){
      SF=0.9957827100852931*0.9972477596587254;
    }
    else if(pt>60          ){
      SF=0.9957335794976617*0.9992036884205017;
    }
  }
  else if(                 fabs(eta)<=0.9 ) {
    if (pt>10. && pt<=20.) {
      float SFid=1.;
      float SFiso=1.;
      //
      if(pt>10. && pt<=13.){
	SFiso=0.984323;
      }
      else if(pt>13. && pt<=16.){
	SFiso=0.974774;
      }
      else if(pt>16. && pt<=20.){
	SFiso=0.976735;
      }
      //
      if(pt>10. && pt<=15.){
	SFid=0.9960358510695144;
      }
      else if(pt>15. && pt<=20.){
	SFid=0.9969411479771049;
      }
      SF = SFid*SFiso;
    }
    else if(pt>20 && pt<=25){
      SF=0.9966102946019978*0.9875967791078082;
    }
    else if(pt>25 && pt<=30){
      SF=0.9969405408294351*0.9887223090090205;
    }
    else if(pt>30 && pt<=40){
      SF=0.9961197193322581*0.9935372601552865;
    }
    else if(pt>40 && pt<=50){
      SF=0.9965773454663823*0.9965575842554589;
    }
    else if(pt>50 && pt<=60){
      SF=0.9970898922428919*0.9972684655153375;
    }
    else if(pt>60          ){
      SF=0.996258852473147*0.9983348483359887;
    }
  }
  
  return SF;  
}
